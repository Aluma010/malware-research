rule krypton_stealer_rule
{
    meta:
        author = "David Cohen, CyberArk"
        date = "04-07-2019"
        vesrion = "1.0"
        hash = "a84f1fe984e6fb04af0e029b67245f2167bcec766959f5033bfbf5ac00f0d396"
        refrence = "https://www.cyberark.com/resources/threat-research-blog/krypton-stealer-kryptonite-for-credentials"
        description = "Yara rule for Krypton Stealer"
    
    strings:
        $main_string = "Krypton Stealer" nocase
        $cc_server = "*.*.ru" nocase
        $check_alive = "id=01&message=test_message" nocase
        $telegram_hacker = "https://t.me/Maltego_X" nocase
        $soft_1 = "Telegram" nocase
        $soft_2 = "Chrome" nocase
        $steal_file = "Login Data" nocase
    
    condition:
        $main_string or
        ($cc_server and $check_alive) or
        ($telegram_hacker and $soft_1 and $soft_2 and $steal_file)
}
