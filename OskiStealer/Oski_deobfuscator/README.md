# Oski Deobfuscator

An IDA Python script for IDA Pro that automates all the analysis of the setup stages for Oski Stealer (v9+) and defeats its obfuscation to make the static analysis easier and more convenient.


![](https://github.com/cyberark/malware-research/OskiStealer/Oski_deobfuscator/oski_usage.gif)


#### Strings Setup

- Find the decryption key

- Decrypt all the strings (B64, RC4)

- Give meaningful names (IDA)

- Add comments with the full decrypted string (IDA)


#### Functions Setup

- Find LoadLibraryA and GetProcAddress

- Resolve the loaded DLLs and functions

- Give meaningful names to functions and DLLs (IDA)


The script dumps the addresses and the full decrypted strings to JSON file named `oski_strings_dump.json`.


## Usage

To use the script, you can load it to IDA while the **courser** is in *Main function* or call the function from IDA command line:

```python
oski_setup(MAIN_ADDRESS)
```

### Before

![Before](https://github.com/cyberark/malware-research/OskiStealer/Oski_deobfuscator/before_script.png)

### After

![After](https://github.com/cyberark/malware-research/OskiStealer/Oski_deobfuscator/after_script.png)
