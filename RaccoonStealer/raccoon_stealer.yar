rule raccoon_stealer_rule
{
  meta: 
    author = "Ben Cohen, CyberArk"
    date = "16-01-2020"
    vesrion = "1.0"
    hash = "a57e1f3217b993476c594570095d28b6c287731a005325e5f64a332a86cb7878"
    refrence = "https://www.cyberark.com/resources/threat-research-blog/raccoon-the-story-of-a-typical-infostealer"
    description = "Yara rule for Raccoon Stealer"

  strings:
    $stealer_typo = "g:\\stealer\\stealler\\json.hpp" wide
    $path1 = "\\Google\\Chrome SxS\\User Data" wide
    $path2 = "\\Chromium\\User Data" wide
    $path3 = "\\Xpom\\User Data" wide
    $path4 = "\\Comodo\\Dragon\\User Data" wide
    $path5 = "\\Amigo\\User Data" wide
    $path6 = "\\Orbitum\\User Data" wide
    $path7 = "\\Bromium\\User Data" wide
    $path8 = "\\Nichrome\\User Data" wide
    $path9 = "\\RockMelt\\User Data" wide
    $path10 = "\\360Browser\\Browser\\User Data" wide
    $DB1 = "Login Data" wide
    $DB2 = "Cookies" wide
    $DB3 = "Web Data" wide 
  condition:
    $stealer_typo or 
    4 of ($path*) and 2 of ($DB*) and
    (uint16(0) == 0x5A4D)
}
